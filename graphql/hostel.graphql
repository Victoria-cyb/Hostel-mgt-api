scalar Date

enum BedStatus {
  available
  reserved
  occupied
  inactive
}

# ========== PUBLIC TYPES ==========

type PublicHostel {
  id: ID!
  name: String!
  gender: Gender!
  status: status!
}

# ========== BASE ENTITIES ==========

type Hostel {
  id: ID!
  space: Space
  name: String!
  gender: Gender!
  status: status!
  rooms: [Room!]
  createdAt: String!
}

type Room {
  id: ID!
  hostel: Hostel
  label: String!
  capacity: Int!
  status: status!
  beds: [Bed!]!
}

type Bed {
  id: ID!
  room: Room
  label: String!
  status: BedStatus!
  amount: Int!
  currentAllocation: Allocation
}

type StayType {
  id: ID!
  space: Space!
  name: String!
  startDate: String!
  endDate: String!
}

# ========== INPUTS ==========
input BedInput {
  label: String!
  status: BedStatus
  amount: Int!
  hostelId: ID
}

input RoomInput {
  label: String!
  capacity: Int!
  status: status
  beds: [BedInput!]
}

input HostelInput {
  name: String!
  gender: Gender!
  status: status
  rooms: [RoomInput!]
}

input UpdateHostelInput {
  name: String
  gender: Gender
  status: status
}

input UpdateRoomInput {
  label: String
  capacity: Int
  status: status
}

input UpdateBedInput {
  label: String
  status: BedStatus
  amount: Int
}

# ========== HOSTEL QUERIES ==========
extend type Query {
  hostels(spaceId: ID!): [Hostel!]! @auth
  publicHostels(spaceId: ID!): [PublicHostel!]!
  hostel(id: ID!): Hostel @auth
  publicHostel(id: ID!): PublicHostel
  rooms(hostelId: ID!): [Room!]! @auth
  room(id: ID!): Room @auth
  beds(roomId: ID!): [Bed!]! @auth
  bed(id: ID!): Bed @auth
  stayTypes(spaceId: ID!): [StayType!]! @auth
  stayType(id: ID!): StayType @auth
}

# ========== HOSTEL MUTATIONS ==========
extend type Mutation {
  createHostel(spaceId: ID!, input: [HostelInput!]!): Boolean!
    @auth
    @spaceAuth(requires: [admin])
  createRoom(spaceId: ID!, hostelId: ID!, input: RoomInput!): Room!
    @auth
    @spaceAuth(requires: [admin])
  createBed(spaceId: ID!, roomId: ID!, input: BedInput!): Bed!
    @auth
    @spaceAuth(requires: [admin])
  updateHostel(spaceId: ID!, id: ID!, input: UpdateHostelInput!): Hostel!
    @auth
    @spaceAuth(requires: [admin])
  updateRoom(spaceId: ID!, id: ID!, input: UpdateRoomInput!): Room!
    @auth
    @spaceAuth(requires: [admin])
  updateBed(spaceId: ID!, id: ID!, input: UpdateBedInput!): Bed!
    @auth
    @spaceAuth(requires: [admin])
  createStayType(
    spaceId: ID!
    name: String!
    startDate: String!
    endDate: String!
  ): StayType! @auth @spaceAuth(requires: [admin])
}
